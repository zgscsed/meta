<!--
 * Copyright (C) 2024 zgscsed. All rights reserved.
 * @filename: file name
 * @Author: zgscsed
 * @Date: 2024-02-08 21:19:16
 * @LastEditors: zgscsed
 * @LastEditTime: 2024-02-11 18:43:12
 * @Description: 模板特化总结
-->

# 模板特化

- [模板特化](#模板特化)
  - [1.1 概述](#11-概述)
    - [1. 类模板特化](#1-类模板特化)
    - [2. 函数模板特化](#2-函数模板特化)
    - [3. 类模板偏特化](#3-类模板偏特化)
    - [4. 函数模板偏特化](#4-函数模板偏特化)
  - [模板匹配规则](#模板匹配规则)

这节内容包括：模板特化概念，匹配规则，特化使用，特化、重载、重写区别。

## 1.1 概述

模板特化是指在模板的泛化版本上，对特定的类型进行特殊化处理的过程。模板特化分为两种：完全特化以及部分特化。  
特化的模板版本在使用时会优先于通用版本。

### 1. 类模板特化

类模板特化是指对类模板中的某些特定类型进行特化，以便对它们进行特殊处理。类模板特化是通过定义一个与通用类模板不同的特化类模板来实现的。

```cpp
template <typename T>
class A {
    // ...
};

template <>
class A<int> {
    // ...
};
```

### 2. 函数模板特化

函数模板特化是指对函数模板中的某些特定类型进行特化，以便对它们进行特殊处理。函数模板特化是通过定义一个与通用函数模板不同的特化函数模板来实现的。
等价于实例化一个函数模板， 存放头文件中注意重复定义的问题。

```cpp
template <typename T>
T add(T a, T b) {
    return a + b;
}

template <>
char add<char>(char a, char b) {
    return a + b - '0';
}
```

### 3. 类模板偏特化

类模板偏特化是指对类模板中的某些特定类型进行特化，以便对它们进行特殊处理。

```cpp
template <typename T1, typename T2>
class A {
    // ...
};

template <typename T>
class A<T, int> {
    // ...
};
```

### 4. 函数模板偏特化

函数模板没有偏特化

```cpp
template <typename T1, typename T2>
T1 add(T1 a, T2 b) {
    return a + b;
}

// 写法有问题， 报错，原因：函数重载，会认为
template <typename T>
T add<T, char>(T a, char b) {
    return a + b - '0';
}
```

## 模板匹配规则

模板匹配：普通优先，特化版本，泛化版本  
模板参数最精确匹配的具有最高的优先权。

函数重载：函数（函数模板）名字相同，但是参数数量或者参数类型上不同

函数模板匹配：
    更精准的匹配会被优先采用
    同样精准的话，更特殊的会被优先采用
    非模板和模板同时都适用的时候，非模板的会被优先采用
    非模板和模板同时都适用的时候，非模板如果需要一次用户定义的类型转换，而模板不需要的话，模板会被优先采用
    非模板函数和模板函数的声明位置，导致结果的不同
    使用函数模板的时候，从最少行参的模板开始匹配